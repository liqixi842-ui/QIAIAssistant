# 📦 动「QI」来 1.0 - 部署到您的服务器

## 🎯 最简单的部署方式（推荐）

我为您准备了**3个方案**，选择最适合您的：

---

## 方案1️⃣：下载+手动部署（最稳妥）

### 第1步：在Replit下载项目

1. 点击页面右上角 **三个点菜单**
2. 选择 **"Download as zip"**
3. 保存文件为 `dongqilai-1.0.zip`

### 第2步：上传到您的服务器

使用 FileZilla、WinSCP 或命令行：

```bash
# 如果使用命令行（在您的电脑上）
scp dongqilai-1.0.zip root@您的服务器IP:/root/
```

### 第3步：SSH登录服务器

```bash
ssh root@您的服务器IP
```

### 第4步：运行一键安装脚本

```bash
# 解压项目
cd /root
unzip dongqilai-1.0.zip -d /var/www/dongqilai
cd /var/www/dongqilai

# 安装环境（自动安装 Node.js、Nginx、PM2）
chmod +x setup.sh
./setup.sh

# 安装项目依赖
npm install --production

# 配置环境变量
cp .env.example .env
nano .env
```

**在 .env 文件中修改：**
- `SESSION_SECRET=` 改成一个随机字符串
- `AI_INTEGRATIONS_OPENAI_API_KEY=` 填入您的 skynetchat.io API密钥

保存后按 `Ctrl+X`，然后 `Y`，再按 `Enter`

### 第5步：启动应用

```bash
# 使用 PM2 配置文件启动
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

### 第6步：配置 Nginx

```bash
# 编辑 nginx.conf 文件
nano nginx.conf
# 将 YOUR_DOMAIN_OR_IP 改成您的域名或IP地址

# 复制到 Nginx 配置目录
cp nginx.conf /etc/nginx/sites-available/dongqilai
ln -s /etc/nginx/sites-available/dongqilai /etc/nginx/sites-enabled/
nginx -t
systemctl restart nginx
```

### 第7步：访问应用

浏览器打开：`http://您的服务器IP`

默认主管账号登录：
- 用户名：`qixi`
- 密码：`hu626388`

---

## 方案2️⃣：通过Git仓库部署

### 前提：您需要一个Git仓库（GitHub/Gitee）

1. 从 Replit 连接 Git 仓库
2. 在服务器上执行：

```bash
ssh root@您的服务器IP

# 运行环境安装脚本（只需一次）
curl -o setup.sh https://您的仓库/setup.sh
chmod +x setup.sh
./setup.sh

# 克隆项目
cd /var/www
git clone 您的仓库地址 dongqilai
cd dongqilai

# 安装和配置
npm install --production
cp .env.example .env
nano .env  # 填入 API 密钥

# 启动
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

---

## 方案3️⃣：使用 Replit 托管（最简单但有月费）

如果您不想管理服务器：

1. 在 Replit 中点击 **"Deploy"** 按钮
2. 选择 **"Autoscale Deployment"**
3. 配置环境变量（在 Secrets 中添加）：
   - `AI_INTEGRATIONS_OPENAI_API_KEY`
   - `SESSION_SECRET`
4. 点击 **"Deploy"**

部署后会获得一个 `.replit.app` 域名，可以绑定自己的域名。

**月费**：约 $20-50（根据使用量）

---

## 🔧 部署后的维护

### 查看运行状态
```bash
pm2 status
pm2 logs dongqilai-1.0
```

### 重启应用
```bash
pm2 restart dongqilai-1.0
```

### 更新应用（如果有新版本）
```bash
cd /var/www/dongqilai
git pull  # 如果使用 Git
npm install --production
pm2 restart dongqilai-1.0
```

---

## ❓ 常见问题

### Q: 无法访问应用？
```bash
# 检查防火墙
ufw status
ufw allow 80
ufw allow 443

# 查看日志
pm2 logs dongqilai-1.0 --lines 50
```

### Q: 想要配置 HTTPS？
```bash
# 安装 SSL 证书（免费）
certbot --nginx -d 您的域名.com
```

### Q: AI 功能不工作？
检查 .env 文件：
```bash
cat .env | grep AI_
```

确保 `AI_INTEGRATIONS_OPENAI_API_KEY` 已正确填写。

---

## 📞 维护支持

**版本**：动「QI」来 1.0

需要维护时，请说：**"需要维护动「QI」来 1.0"**

---

## ✅ 部署检查清单

- [ ] 服务器已安装 Node.js、Nginx、PM2
- [ ] 项目已上传到 `/var/www/dongqilai`
- [ ] `.env` 文件已配置（API密钥、SESSION_SECRET）
- [ ] PM2 已启动应用
- [ ] Nginx 已配置并重启
- [ ] 防火墙已开放 80、443 端口
- [ ] 浏览器可以访问应用
- [ ] 主管账号 (qixi/hu626388) 可以登录

---

**祝您部署顺利！** 🚀

有任何问题随时找我协助！
